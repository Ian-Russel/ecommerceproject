<div class="products-page">
  <div class="page-hero">
    <h1>Our Footwear Collection</h1>
    <p>Discover premium quality in every step</p>
  </div>

  <div class="products-container">
    <div *ngFor="let category of productsCategory" class="category-section">
      <div class="category-header">
        <h2 class="category-title">{{category.categoryName}}</h2>
        <span class="category-count">{{category.products.length}} items</span>
      </div>
      
      <div class="products-grid">
        <div *ngFor="let prod of category.products" class="product-card">
          <!-- Badges -->
          <div class="product-badges">
            <span *ngIf="prod.isNewArrival" class="badge new">New</span>
            <span *ngIf="prod.isBestSeller" class="badge bestseller">Best Seller</span>
            <span *ngIf="prod.discountPercentage > 0" class="badge discount">-{{prod.discountPercentage}}%</span>
            <span *ngIf="prod.stockQuantity === 0" class="badge out-of-stock">Out of Stock</span>
          </div>

          <div class="product-image-wrapper">
            <img 
              class="product-image" 
              [src]="'../assets/products/' + prod.imageFile + '.jpg'" 
              [alt]="prod.name"
              loading="lazy"
            />
          </div>
          
          <div class="product-info">
            <div class="product-header">
              <h3 class="product-name">{{prod.name}}</h3>
              <span *ngIf="prod.brand" class="product-brand">{{prod.brand}}</span>
            </div>

            <p class="product-description">{{prod.description}}</p>
            
            <!-- Rating -->
            <div *ngIf="prod.rating > 0" class="product-rating">
              <span class="stars">★ {{prod.rating}}</span>
              <span class="review-count">({{prod.reviewCount}} reviews)</span>
            </div>

            <div class="product-meta">
              <span *ngIf="prod.color" class="meta-item">
                <span class="color-dot" [style.background-color]="prod.color"></span>
                {{prod.color}}
              </span>
              <span *ngIf="prod.gender" class="meta-item">{{prod.gender}}</span>
              <span *ngIf="prod.unitOfMeasure" class="meta-item">{{prod.unitOfMeasure}}</span>
            </div>

            <div class="product-footer">
              <div class="price-container">
                <span 
                  *ngIf="prod.discountPercentage > 0" 
                  class="product-price-original">
                  <s>₱{{prod.price}}</s>
                </span>
                  <span class="product-price">
                    ₱{{formatPrice(calculateDiscountedPrice(prod))}}
                  </span>
              </div>

              <button 
                class="add-to-cart-btn" 
                (click)="addToCart(prod)"
                [disabled]="prod.stockQuantity === 0"
                [class.disabled]="prod.stockQuantity === 0"
                aria-label="Add to cart">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <circle cx="9" cy="21" r="1"/>
                  <circle cx="20" cy="21" r="1"/>
                  <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"/>
                </svg>
                {{prod.stockQuantity === 0 ? 'Out of Stock' : 'Add to Cart'}}
              </button>
            </div>

            <!-- Stock indicator -->
            <div *ngIf="prod.stockQuantity > 0 && prod.stockQuantity <= 5" class="stock-warning">
              Only {{prod.stockQuantity}} left in stock!
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>